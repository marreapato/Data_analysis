library(tidyverse)
  #install.packages("tidyverse")
#summary statistics
#install.packages("psych")
#install.packages("pastecs")
#install.packages("skimr")
#library(psych)
#library(pastecs)
#library(skimr)
terrorism <- read.csv("Terrorism.csv")
attach(terrorism)

summary(terrorism)

#describe(terrorism)

#describing data by region

avgkill=terrorism %>% group_by(region=region_txt) %>%summarise(mean=round( mean(nkill,na.rm = T)),sd=round(sd(nkill,na.rm=T)),quartile3=trunc(quantile(nkill,probs = (0.75),na.rm=T)) )
avgkill
#average n of kills per region
#?quantile()
statsperp=terrorism %>% group_by(region_txt) %>% summarise(mean=round(mean(nperps,na.rm=T)),sd=round(sd(nperps,na.rm=T)),quartile3=trunc(quantile(nperps,probs = (0.75),na.rm=T)))
statsperp

propextreg<-terrorism[,c(20,5)]

library(ggthemes)
detach(terrorism)

#damage barplot
propextreg1 <-propextreg %>%  filter(propextent_txt=="Minor (likely < $1 million)")
propextreg2 <-propextreg %>%  filter(propextent_txt=="Major (likely >= $1 million but < $1 billion)")
propextreg3 <-propextreg %>%  filter(propextent_txt=="Catastrophic (likely >= $1 billion)")
?theme()
g1=ggplot(na.omit(propextreg1),aes(propextent_txt,fill=region_txt))+geom_bar(position = "dodge")+theme_few()+theme(legend.position = "none")+scale_fill_ptol()+labs(y="Frequency",title = "Damage caused per region",x="Regiões",fill="Regiões")
g2=ggplot(na.omit(propextreg2),aes(propextent_txt,fill=region_txt))+geom_bar(position = "dodge")+theme_few()+scale_fill_ptol()+labs(y="Frequency",title="Damage caused per region",x="Regions",fill="Region")
g3=ggplot(na.omit(propextreg3),aes(propextent_txt,fill=region_txt))+geom_bar(position = "dodge")+scale_fill_ptol()+theme_few()+labs(y="Frequency",title="Damage caused per region",x="Regions",fill="Region")
#plotting with opnly one legend
#install.packages("digest")
library(digest)
library(gridExtra)
grid.arrange(g1, g2,g3, ncol=2)#i'm gonna see what to do here now,
#in order to be able to change the third plot

g3
#install.packages("devtools")
library(devtools)


world <-map_data('world') %>% filter(region != "Antarctica") %>% fortify
 map_data("world") # we already did this, but we can do it again

ggplot(world, aes(x=long, y=lat, group=group)) +
  geom_polygon(fill="grey", colour="black",show.legend = T)+
  geom_point(data=terrorism, aes(y=terrorism$latitude, x=terrorism$longitude, colour=terrorism$region_txt, group=terrorism$region_txt,
                         size=terrorism$nkill))+
  labs(colour="Region",size="Number of deaths")+
  geom_path() + coord_map("mercator")+theme_map()
#install.packages("leaflet")
  terr <- na.omit(terrorism)
  sum(is.na(terrorism)==F)
  cont=0
  
  
  
  #could be useful to make ml model later
  for(i in 1:24){
    
  if(sum(is.na(terrorism[,i]))>4557){
    terror <- terrorism[,-i]
  }
  
    }
  
terror <- terror[,c(23,22,19,5)]
terror <- na.omit(terror)  

   
